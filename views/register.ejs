<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>

<body class="text-center">
    <div style="position: absolute; top: 20%; left: 40%; ">
        <h1 class="h3 mb-3 fw-normal"> Register </h1>

        <form action="/register" method="POST">
            <div class="form-floating p-1 rounded">
                <input placeholder="Name" type="text" id="name" name="name" required />
            </div>
            <div class="form-floating p-1 rounded">
                <input placeholder="Email Address" type="email" id="email" name="email" required />
            </div>
            <div class="form-floating p-1 mb-1 rounded">
                <input placeholder="Password" type="password" id="password" name="password" required />
            </div>

            <button class="w-20 btn btn-lg btn-primary" type="submit">Register</button>

            <!-- bootstrap light button similar to Register, with text 'create using snap' -->
            <button class="w-20 btn btn-lg btn-dark" onclick="generatePassword()">Create using snap</button>
            <!-- send hello button (white, small) -->
            <button class="w-20 btn btn-sm btn-light" onclick="sendHello()">Send hello</button>
            <div>
                <a href="/login" class="text-muted">Login</a>
            </div>

        </form>
    </div>
</body>

<script>
    const snapId = `local:http://localhost:8081/`;

    async function generatePassword() {

        // install snap
        await ethereum.request({
            method: 'wallet_enable',
            params: [{
                wallet_snap: { [snapId]: {} },
            }]
        })

        //get list of connected snaps
        installedSnaps = await ethereum.request({method: 'wallet_getSnaps'});
        console.log(installedSnaps);

        // call generate password
        let newPassword = await ethereum.request({
            method: 'wallet_invokeSnap',
            params: [
                snapId,
                {
                    method: 'generatePassword',
                }
                
            ]
        })

        console.log(newPassword)

    }

    async function sendHello() {
        await ethereum.request({
            method: 'wallet_invokeSnap',
            params: [
                snapId,
                {
                    method: 'hello'
                }
            ]
        })
    }


</script>